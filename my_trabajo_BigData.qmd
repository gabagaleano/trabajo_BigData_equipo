---
title: "Homicidios por el Mundo"
description: |
  Exploramos las tasas de homicidios, controlando por variables de sexo y población.
author:   
  - Gabriela Galeano\n   
  - Arantxa Arcos\n
  - Lucía Bellido
date: 2025-12-17                           #--
categories: [trabajo BigData, homicidios]      #--
image: "./imagenes/imagen_01.png"
title-block-banner: true #- {true, false, "green","#AA0000"}
title-block-banner-color: "red"    #-"#FFFFFF" 
toc-depth: 3
smooth-scroll: true
format: 
  html:
    #backgroundcolor: "#F1F3F4"
    #embed-resources: true
    link-external-newwindow: true
    #css: assets/my_css_file.css   #- CUIDADO!!!!
code-tools: true
code-link: true
---

## Introducción

Vamos a utilizar datos de *Our World in Data*,[^1] enfocándonos en los datasets que contienen el país, código, tasa de homicidio como porcentaje de la población,luego por género del homicida y por género de la víctima.

[^1]: Los datasets fueron descargados por última vez el 12 de Diciembre de 2025. Desde https://ourworldindata.org/homicides


Los datos se pueden cargar en la memoria de de R/RStudio de esta forma:

```{r}
#install.packages("readr")

library(readr)

tasa_mujeres <- read_csv("datos/female-homicide-rate.csv")
tasa_total <- read_csv("datos/homicide-rate-unodc.csv")
tasa_sexo_victimas <- read_csv("datos/homicides-by-sex-of-the-victim.csv")
tasa_hombres <- read_csv("datos/male-homicide-rate.csv")
```

Como son datasets separados, unimos la tasa de mujeres y hombres a la total en base a la variable Code, para trabajar de manera más cómoda:

```{r}
library(tidyverse)

df_generos <- left_join(tasa_hombres,tasa_mujeres)
df_tasas <- left_join(df_generos,tasa_total)

rm(df_generos, female_homicide_rate, homicide_rate_unodc, tasa_hombres, tasa_mujeres, tasa_total)
```

Luego renombramos las variables para trabajar de manera más cómoda

```{r}
names(df_tasas)

df_tasas <- df_tasas %>%
  rename(female = "Homicide rate per 100,000 population - sex: Female - age: Total") %>%
  rename (male = "Homicide rate per 100,000 population - sex: Male - age: Total" ) %>%
  rename (total = "Homicide rate per 100,000 population - sex: Total - age: Total")

names(tasa_sexo_victimas)

tasa_sexo_victimas <- tasa_sexo_victimas %>%
  rename(female = "Homicides - sex: Female - age: Total") %>%
  rename (male = "Homicides - sex: Male - age: Total" )

```

------------------------------------------------------------------------

## Motivación

¿Por qué las personas se matan entre sí? No responderemos a esa pregunta, pero exploraremos las tasas de homicidio a nivel global y por país. Además, dividiremos por sexo, tanto de la víctima como del criminal, para añadir una capa adicional al estudio. A partir de ahí, recopilamos los datos mencionados anteriormente para analizar la evolución de las tasas de homicidio a lo largo de las últimas décadas.

Responderemos distintas cuestiones como qué país tiene la tasa de homicidio más alta, y en qué año, la tendencia general, cómo han cambiado las tasas de cada país en 2000 y 2020; y cómo cambia esta evolución cuando se controla por sexo (del criminal y la víctima).

Para contextualizar, el homicidio provoca muchas más muertes que los conflictos armados y el terrorismo combinados, por lo que es una causa significativa de muerte a nivel mundial, según los datos de 2021, la tasa media mundial de homicidios fue de aproximadamente 5,8 víctimas por cada 100.000 habitantes.[^2] El término proviene etimológicamente del latín homicidĭum, un compuesto de homo, ‘ser humano’, y caedere, ‘matar’. Tiene distintas clasificaciones según las intenciones del criminal y la naturaleza del delito (doloso, involuntario, simple…).[^3]

Un dato curioso, o desalentador, es que el 60% de los asesinatos de mujeres a nivel mundial son femicidios cometidos por parejas o familiares, una proporción muy superior a la de los hombres.[^4]


[^2]: Dato extraido de United Nations Office on Drugs and Crime. (2023). Global study on homicide 2023: Chapter 2 [PDF]. United Nations. https://www.unodc.org/documents/data-and-analysis/gsh/2023/GSH23_Chapter_2.pdf

[^3]: Información de Wikipedia. (s. f.). Homicidio. En Wikipedia, la enciclopedia libre. Recuperado [día mes año], de https://es.wikipedia.org/wiki/Homicidio

[^4]: Dato de United Nations Office on Drugs and Crime & UN Women. (2024). Femicides in 2023: Global estimates of intimate partner/family member femicides [Research brief]. United Nations. https://www.unodc.org/documents/data-and-analysis/briefs/Femicide_Brief_2024.pdf


::: column-margin
![](./imagenes/imagen.jpeg){fig-align="center"}
:::

------------------------------------------------------------------------

## Visión global

Para visualizar un poco los datos, vamos a realizar una tabla que nos muestre los 10 países y años en los que más homocidios han sucedido. La tasa de homicidios aparece por cada 100,000 habitantes del país.

```{r}

#install.packages("gt")
library(gt)

gt_tasas <- df_tasas %>% 
  group_by(Entity) %>% 
  select (Entity, Code, Year, male, female, total) %>% 
  arrange (desc(total)) %>%
  head(10) %>% 
  ungroup ()

gt_tasas %>% 
  gt() %>% 
  fmt_flag(columns = Code, height = 30)

```

En esta tabla podemos observar cómo se repiten los distintos países. Además, un resultado a destacar es la continuidad de los años en los que se produce una mayor tasa de homicidio. Cabe mencionar que, a pesar de que El Salvador es el que aparece como el país con mayor tasa en 2015, Colombia es el que durante más años ha llevado un índice de homicidio mayor, debido a su periodo en la década de los 90 de altos cambios. 


## Tendencias

Con el objetivo de analizar la evolución de las tasas de homicidio vamos a realizar unos gráficos de tendencia lineal para mujeres, hombres y el total. De esta forma, veremos cómo las tasas han cambiado durante los años. 

En este primer gráfico, observamos la evolución de la tasa de mujeres. En este caso, destacan Colombia, Honduras, Albania, entre otros, debido a que estamos buscando aquellos países cuya tasa sea mayor a 10 por cada 100.000 habitantes.


```{r}

library(patchwork)
library(ggplot2)
library(gghighlight) #install.packages(gghighlight)
library(paletteer)


p1 <- ggplot(df_tasas,
       aes(x = Year,
           y = female,
           colour = Entity)) +
  geom_line(linewidth = 0.5) +
  theme_bw() +
  theme(legend.position = "none") +
  labs(
    x = "Años",
    y = "Tasa de mujeres",
    title = "Tendencia mujeres por país",
    subtitle = "por cada 100.000 habitantes") + 
  gghighlight(max(female) > 10, use_direct_label = TRUE) +
    scale_colour_manual(values = paletteer_d("RColorBrewer::RdGy"))

p1

```
A continuación, vemos la evolución de la tasa total. Por tanto, buscamos aquellos países cuya tasa sea mayor a 50 por cada 100.000 habitantes. Destacan Jamaica, Honduras y Colombia.

```{r}

p2 <- ggplot(df_tasas,
       aes(x = Year,
           y = total,
           colour = Entity)) +
  geom_line(linewidth = 0.5) +
  theme_bw() +
  theme(legend.position = "none") +
  labs(
    x = "Años",
    y = "Tasa total",
    title = "Tendencia total por país",
    subtitle = "por cada 100.000 habitantes") +
   gghighlight(max(total) > 50, use_direct_label = TRUE) +
      scale_colour_manual(values = paletteer_d("RColorBrewer::RdGy"))


p2

```
En este tercer gráfico, vemos la evolución de la tasa de hombres. Así pues, realizamos un gráfico en el que destaque naquellos países cuya tasa sea mayor a 80 por cada 100.000 habitantes. Destacan Honduras, Colombia, Jamaica, Ecuador, entre otros.

Por último, ponemos en una sola imagen los tres gráficos para tener una imagen más global de todas las evoluciones.

```{r}

p3 <- ggplot(df_tasas,
       aes(x = Year,
           y = male,
           colour = Entity)) +
  geom_line(linewidth = 0.5) +
  theme_bw() +
  theme(legend.position = "none") +
  labs(
    x = "Años",
    y = "Tasa de hombres",
    title = "Tendencia hombres por país",
    subtitle = "por cada 100.000 habitantes") + 
  gghighlight(max(male) > 80, use_direct_label = TRUE) +
      scale_colour_manual(values = paletteer_d("RColorBrewer::RdGy"))


p3

```
Para continuar con el análisis anterior hemos gráficado los tres países en los que se han cometido más homicidios en ciertos años. Así pues, vamos a ver su evolución.
```{r}

paises <- c("El Salvador", "Honduras", "Colombia")

paises_destacados <- df_tasas %>%
  filter( Entity == paises)

p4 <- ggplot(paises_destacados,
       aes(x = Year,
           y = total,
           colour = Entity)) +
  geom_line(linewidth = 1) +
  theme_bw() +
  labs(
    x = "Años",
    y = "Tasa total",
    title = "Tendencia por países",
    subtitle = "por cada 100.000 habitantes") +
      scale_colour_manual(values = paletteer_d("RColorBrewer::RdGy"))


p4

((p1 + p2 + p3) &
   theme(plot.title = element_blank(),
         plot.subtitle = element_blank())) +
  plot_annotation(title = "Comparación de tendencias",
    theme = theme(
      plot.title = element_text(size = 16, face = "bold", hjust = 0.5))) +
      scale_colour_manual(values = paletteer_d("RColorBrewer::RdGy"))


```


## Mapas

Otra manera de visualizar las diferentes tasas de homicidio por país es en mapas. Aquí realizamos 4 mapas, uno con los valores de las tasas en el 2000, otro en el 2020; y luego una versión interactiva del mapa del año 2000. Aquí observamos que en el 2000 Colombia tenía los valores más altos, y que en el 2020 ningún país llega a los extremos más altos. Esto coincide con la tendencia negativa global que ha tenido la tasa de homicidio total, y por género (que observamos en el análisis por tendencias previo).

### Estáticos

```{r}

library("rnaturalearth")
library("rnaturalearthdata")
library("ggplot2")
library("patchwork")

world <- rnaturalearth::ne_countries(scale = "medium", returnclass = "sf")
  
# Arreglamos un poco el data de donde sacamos las geometrías
world <- world %>% 
  # Quitamos Antarctica y Groenlandia
  filter(subregion != "Antarctica") %>% filter(admin != "Greenland") %>% 
  # Nos quedamos solo con las 2/3 variables que hacen falta
  select(name, iso_a3, geometry) 

# Juntamos los dfs, para tener la geometría junto con nuestro data de las tasas
df_mapa <- world %>%
  left_join(df_tasas, by = c("iso_a3" = "Code"))

# Filtramos y creamos 2 datasets para mostrar los mapas en 2 años distintos, 2000 y 2020
df_mapa_2000 <- df_mapa %>% filter(Year == 2000)
df_mapa_2020 <- df_mapa %>% filter(Year == 2020)

map_2000 <- ggplot(df_mapa_2000) +
  geom_sf(aes(fill = total), color = "white", linewidth = 0.2) +
  scale_fill_distiller(
    palette = "RdGy",  
    direction = 1,  
    na.value = "grey90"
  ) +
  labs(title = "Tasa total por país (2000)")

map_2020 <- ggplot(df_mapa_2020) +
  geom_sf(aes(fill = total), color = "white", linewidth = 0.2) +
  scale_fill_distiller(
    palette = "RdGy",
    direction = 1,
    na.value = "grey90"
  ) +
  labs(title = "Tasa total por país (2020)")


map_2000 + map_2020
```

### Interactivos

Como mencionado antes, aquí vemos el valor de las tasas en cada país en los años 2000 y 2020 (respectivamente):

```{r}

library(leaflet)
library(RColorBrewer)

pal <- colorBin(
  palette  = "RdGy",
  domain   = df_mapa$total,
  bins     = 6,
  na.color = "#f0f0f0"
)


leaflet(df_mapa_2000) %>%
  addTiles() %>%
  addPolygons(
    fillColor   = ~pal(total),
    fillOpacity = 0.8,
    color       = "white",
    weight      = 0.3,
    popup = ~paste0(
      "<strong>", name, "</strong><br/>",
      "Total: ", total
    ),
    highlightOptions = highlightOptions(
      weight = 2,
      color = "#666",
      fillOpacity = 0.9,
      bringToFront = TRUE
    )
  ) %>%
  addLegend(
    pal      = pal,
    values  = ~total,
    title   = "Total",
    position = "bottomright"
  ) |> 
  addControl(
  html = "Código inspirado en https://r-graph-gallery.com/183-choropleth-map-with-leaflet.html",
  position = "bottomleft"
)



leaflet(df_mapa_2020) %>%
  addTiles() %>%
  addPolygons(
    fillColor   = ~pal(total),
    fillOpacity = 0.8,
    color       = "white",
    weight      = 0.3,
    popup = ~paste0(
      "<strong>", name, "</strong><br/>",
      "Total: ", total
    ),
    highlightOptions = highlightOptions(
      weight = 2,
      color = "#666",
      fillOpacity = 0.9,
      bringToFront = TRUE
    )
  ) %>%
  addLegend(
    pal      = pal,
    values  = ~total,
    title   = "Total",
    position = "bottomright") |> 
  addControl(
  html = "Código inspirado en https://r-graph-gallery.com/183-choropleth-map-with-leaflet.html",
  position = "bottomleft"
)

```

------------------------------------------------------------------------

## Víctimas globales por sexo

En el siguiente gráfico mostramos las víctimas por sexo mundialmente. Podemos ver que hay una gran diferencia entre hombres y mujeres, en la que la tasa de hombres global está muy por encima. Esto es debido a que un gran porcentaje de homicidios, en torno al 80%, producidos por hombres son entre ellos y a que estos son los que mayoritariamente se encuentran frente a fenómenos violentos como las guerras.

```{r}
mujeres <- tasa_sexo_victimas %>% 
  group_by(Year) %>% 
  filter(Code == "OWID_WRL") %>% 
  filter(Year >= 2000) %>% 
  filter(Year < 2020) %>% 
  select(Year, female) %>% 
  ungroup()

hombres <- tasa_sexo_victimas %>% 
  group_by(Year) %>% 
  filter(Code == "OWID_WRL") %>% 
  filter(Year >= 2000) %>% 
  filter(Year < 2020) %>% 
  select(Year, male) %>% 
  ungroup()

sexos <- ggplot() +
  geom_point(data = mujeres, 
             aes(x = Year, y = female, colour = "Mujeres")) + 
  geom_line(data = mujeres, 
            aes(x = Year, y = female, colour = "Mujeres")) + 
  geom_point(data = hombres, 
             aes(x = Year, y = male, colour = "Hombres")) + 
  geom_line(data = hombres, 
            aes(x = Year, y = male, colour = "Hombres")) +
  labs(
    x = "Año", 
    y = "Tasa de homicidio global",
    title= "Víctimas globales por sexo",
    colour = "Sexo"
  ) +
    scale_colour_manual(values = paletteer_d("RColorBrewer::RdGy")) +
  scale_y_continuous(
    limits = c(0, NA),
    breaks = c(1e5, 2e5, 3e5),
    labels = c("100 mil", "200 mil", "300 mil"))


sexos

```




<br>

## Conclusiones

Como bien hemos podido observar a lo largo del trabajo, el homicidio es una causa común de muerte que en la mayoría de países ha tenido una tasa que no podemos pasar por alto. 

A continuación, haremos un recorrido por todo el estudio:

Por un lado, podemos ver los distintos países y años donde más homicidios se han producido siendo los países de Latinoamérica los más destacados. 

Por otro lado, las tasas según sexos y global tienden a decrecer en todos los países, incluso en los que más muertes se producen. Con esta tendencia negativa podemos entender que, a medida que pasan los años, los estados tienen más controlados los homicidios y se toman más medidas en cuanto a injusticias como estas.
Además, cabe mencionar que tanto Colombia como Honduras, son los países más destacados por su historia.

Por otra parte, realizamos un visionado global donde claramente se pueden diferenciar las tasas en los distintos países en años clave como los 2000 y 2020.

Finalmente, acabamos nuestro trabajo tratando las diferencias entre muertes masculinas y femeninas. Según *Our World in Data*, la mayor tasa de víctimas masculinas se debe a que los hombres están más expuestos a violencia letal y en espacios públicos, asociada a conductas de riesgo y al crimen organizado. No obstante, las mujeres sufren altos niveles de violencia, especialmente en el ámbito doméstico, aunque esta suele estar sub registrada, por lo que aparece menos en las estadísticas generales.



<br>

Aquí termina nuestro trabajo de Big Data! ;)

<br>

